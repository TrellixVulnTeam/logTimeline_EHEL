<html>
<head>
<style>


.tabel {
    
    height: 400px;
	width: 28%;
	margin-top: 25px;
	
	
  	
  	overflow-y: scroll;
  	
}

.image-upload>input {
  display: none;
}

.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 15%;
}
.heading {
  text-align: center;
  font-size:35px;
  font-family:'Courier New', Courier, monospace;
  text-shadow: 2px 2px 5px grey;
  opacity: 0.8;
}

</style>



<script src="papaparse.min.js"></script>
<script src="canvasjs.min.js"></script>
<script src="jquery-3.3.1.js"></script>
<script src="moment.js"></script>
<script src="moment-with-locales.js"></script>


<script>





window.onload = function () {
	


    $("#csv-file").change(handleFile);
	$('#csv-file').attr('disabled',false);
    
}




function handleFile(evt){
    var file = evt.target.files[0];
    var timeline_data = new Array();
    Papa.parse(file, {
        header: true,
		skipEmptyLines: true,
        dynamicTyping: true,
        complete: function(results) {
        timeline_data = results['data'];
        console.log("got file");
        console.log(timeline_data);
		$('#imageDiv').hide();
        throwChart(timeline_data);
		throwTable(timeline_data);
	}
    });
    
    
}


function throwTable(timeline_data){

	var obj = timeline_data;

	var tbody = document.getElementById('tbody');

	for (var i = 0; i < obj.length; i++) {
    var tr = "<tr>";

    tr += "<td>" + moment(obj[i].x).format("YYYY MMM DD HH:mm:ss.SSS") + "</td>" + "<td>" + obj[i].z.toString() + "</td></tr>";

    tbody.innerHTML += tr;
}
}

function throwChart(TimelineData){
    var chartData = TimelineData;
    var chart = new CanvasJS.Chart("chartContainer", {
	animationEnabled: true,
	backgroundColor: "#DCDCDC",
	
	zoomEnabled: true,
	title:{
		text: ""
	},
	subtitles:[
		{
			text: "1-Video",
			
			horizontalAlign: "left",
			fontStyle: "normal",
			//fontColor: "blue",
			fontFamily: "arial",
			
		},
		{
			text: "2-Notifications",
			
			horizontalAlign: "left",
			fontStyle: "normal",
			//fontColor: "blue",
			fontFamily: "arial",
			
		},
		{
			text: "3-Settings",
			
			horizontalAlign: "left",
			fontStyle: "normal",
			//fontColor: "blue",
			fontFamily: "arial",
			
		},
		{
			text: "4-Keypresses",
			
			horizontalAlign: "left",
			fontStyle: "normal",
			//fontColor: "blue",
			fontFamily: "arial",
			
		}
	
		],
	axisX: {
		title:"Time",
		labelAngle: -30
	},
	axisY:{
		title: "Timelines",
		interval: 1
	},
	data: [{
		type: "scatter",
		
		color: "red",
		toolTipContent: "{z} ",
		name: "      ",
		
        showInLegend: true,
        xValueType: "dateTime",
		dataPoints: chartData,
		
	}
	]
});
chart.render();

}


</script>
</head>
<body background="subtle.jpg">
<div class="heading">
	<h1>Customer Timeline</h1>

</div>



<div id = "imageDiv" class="image-upload">
	<label for="csv-file">
		<img src="button.png" class="center"/>
	</label>

	<input id="csv-file" type="file" name="files"/>
</div>

<div id="chartContainer" style="height: 500px; width: 100%; bgcolor: rgba(150, 147, 147); box-shadow: 10px 10px 5px grey">
</div>


<div class="tabel">

	
<table border="1", rules="all", cellspacing="40", cellpadding="10", bgcolor="#DCDCDC">

<tbody id="tbody">


</tbody>

</table>
</div>
</body>
</html>